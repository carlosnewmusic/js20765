<!DOCTYPE html>
<html>

<head>
    <!--
        HACER UNA APP QUE HAGA LO SIGUIENTE:

         LA PÁGINA DEBE PENSAR UN NÚMERO DEL 1 AL 100
        Y DEBE DARLE 5 OPORTUNADIDES MÁXIMO AL USUARIO
        PARA ADIVINARLO

        DEBEMOS MOSTRAR UN CONTADOR DE LAS VIDAS QUE LE QUEDAN
        AL USUARIO EN TODO MOMENTO

        DEBEMOS INFORMARLE CADA VEZ QUE PRUEBA SI 
        EL NUMERO INTROUCIDO ES MENOR O MAYOR QUE EL BUSCADO
        A MODO DE PISTA

        SI LO ACIERTA, LE FELICTAMOS CON UN GIF ANIMADO
        SI FALLA, IGUAL, PERO ADEMAS, LE INDICAMOS EL NÚMERO BUSCADO



    -->
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <!-- <link rel='stylesheet' type='text/css' media='screen' href='main.css'> -->
    <script>
        //mostrarNombreJugador ();
       

        this.onload = inicio;//SIN PARÉNTESIS programa el listener vs CON paréntesis llama en este momento
        const NUM_INTENTOS_MAX = 5;
        const RUTA_FOTO_PIERDE = "https://media.tenor.com/images/9ff77762b2ae15c8f78fb711982fbf73/tenor.gif";
        const RUTA_FOTO_GANA = "https://i.pinimg.com/originals/0e/68/6f/0e686faa391f1f47ab74fd21a3124103.gif";
        let naleatorio;//ámbito global : accesible desde todas las funciones
        let num_intentos;//declaro
        let elemento_imagen_res;
        let numeros_jugados;//array de numeros jugados


        function infoNombre ()
        {
            
            let nombre = localStorage.getItem("nombre_jugador");
            console.log ("nombre_jugador = "+ nombre);
        
        }

        function ocultarEnlaces ()
        {
            let enlaces = document.getElementsByTagName("a");
            for (enlace of enlaces)
            {
                enlace.style.visibility = "hidden";
            }

        }

        function mostrarNombreJugador ()
        {
            let nombre = localStorage.getItem("nombre_jugador");
            if (nombre)
            {
                document.getElementById("nombre_jugador").innerHTML = "Bienvenido, " +nombre;
            } else {
                console.log ("NO EXISTE nombre. No se puede jugar. A la página uno");
                document.getElementById("divjuego").style.visibility="hidden";
                document.getElementById("mensaje_nombre_obligatorio").style.visibility="visible";
            }
            
        }

        function mostrarEnlaces ()
        {
            let enlaces = document.getElementsByTagName("a");
            enlaces[0].style.visibility = "visible"
            enlaces[1].style.visibility = "visible"
            /*for (enlace of enlaces)//recorrer : ir de princiio a fin de una estruc
            {
                enlace.style.visibility = "visible";
            }*/

        }
        function inicio() {
            //CALCULAR EL NUMERO ALEATORIO
            mostrarNombreJugador();
            naleatorio = Math.floor(Math.random() * 100) + 1;
            console.log ("Num secreto "+ naleatorio);
            num_intentos = 0;
            document.getElementById("vidas").innerHTML = NUM_INTENTOS_MAX;
            elemento_imagen_res = document.querySelector("img");
            //document.querySelector("a").style.visibility = "hidden";
            ocultarEnlaces ();
            mostrarNombreJugador();
            //INICIAMOS EL ARRAY DE NUMEROS
            numeros_jugados=[];//inicializo init
            
            
        }
        function comprobarIntento() {

            //1 obtener el número intro por el usuario
            let nuser = document.getElementById("num_usuario").value;
            console.log("numero usr = " + nuser);
            numeros_jugados.push(nuser);//actualizo el array
            //ordenar
            numeros_jugados.sort();
            //muestro el array
            document.getElementById("numeros_jugados").innerHTML=numeros_jugados;
            //2 compararlo con el que hay que adivinar
            //si IGUAL
            //MOSTRAR EL GIF INFO EXITO
            if (nuser == naleatorio) {
                console.log("ACIERTO!");
                document.getElementById("info").innerHTML="HAS ACERTADO";
                elemento_imagen_res.setAttribute ("src", RUTA_FOTO_GANA);
                //document.querySelector("a").style.visibility = "visible";
                mostrarEnlaces();
            }
            //si MAYOR
            //INFORMAR MAYOR
            //restar intentos disponibles
            else {
                console.log("Ha fallado");
                num_intentos++;
                //actualizo intentos
                document.getElementById("vidas").innerHTML = NUM_INTENTOS_MAX - num_intentos;
                //QUEDAN VIDAS?
                if (nuser > naleatorio) {
                    console.log("el buscado es menor");
                    document.getElementById("info").innerHTML="el buscado es menor";
                }
                //si MENOR
                //INFORMAR MENOR
                //restar intentos disponibles 
                else {
                    console.log("el buscado es mayor");
                    document.getElementById("info").innerHTML="el buscado es mayor";
                }

                if (num_intentos == NUM_INTENTOS_MAX) {
                    console.log("SE ACABÓ");
                    document.getElementById("info").innerHTML="Perdiste. Buscábamos el " + naleatorio;
                    elemento_imagen_res.setAttribute ("src", RUTA_FOTO_PIERDE);
                    //document.querySelector("a").style.visibility = "visible";
                    mostrarEnlaces();
                }

            }


        }

        function cambiarNombre ()
        {
            location.href="intronombre.html?cambiar=true";
        }

        function reiniciar()
        {
            console.log("toco reiniciar");
            //location.href = "juego.html";
            location.reload();
           /* document.querySelector("a").style.visibility = "hidden";
            document.querySelector("img").setAttribute ("src","" );
            document.getElementById("info").innerHTML="";
            document.getElementById("num_usuario").value="";
            inicio();*/
        }


    </script>
</head>

<body>
    <div id="divjuego">
        <div id="nombre_jugador"></div>
        <a href="#" onclick="reiniciar()">VOLVER A JUGAR</a>
        <a href="#" onclick="cambiarNombre()">CAMBIAR NOMBRE</a>
        <!-- <a href="juego.html" onclick="reiniciar()">VOLVER A JUGAR</a> -->
        <br>
        <input type="number" id="num_usuario">
        <input type="button" value="PROBAR" onclick="comprobarIntento()">
        <div id="vidas"></div>
        <div id="intetos">VIDAS</div>
        <div id="numeros_jugados"></div>
        <div id="info"></div>
        <img id="imgres">
    </div>
   
    <div id="divnojuego">
        <a href="intronombre.html" id="mensaje_nombre_obligatorio" onclick="cambiarNombre()">DEBE INTRODUCIR UN NOMBRE OBLIGATORIO</a>
    </div>

</body>

</html>